# Project Brief: 产品过程数据中心

> 草案版本：0.1（2025-10-14）

## Introduction

本简报用于指导“产品过程数据中心（试验领域）”的立项与MVP落地，明确范围、目标与度量，并作为后续PRD/架构输入的上游文档。

- 工作模式：交互式协同起草（本次选择）
- 输出位置：`docs/brief.md`
- 输入材料：
  - 头脑风暴纪要（`docs/brainstorming-session-results.md`）
  - 你提供的其他补充输入（将按后续章节逐步纳入）
- 能力边界：聚焦“数据中心”的汇聚/标准化/洞察/服务；不包含TDM/现场试验执行与流程控制。
- 近期关注：三大MVP方向（需求验证矩阵；设计×仿真×试验协同看板与模型校准；试验知识图谱）。

（如需更换输出路径或追加背景资料，可在任一章节的征询阶段提出。）

## 项目简介

项目“产品过程数据中心”是面向复杂装备研制的前端原型，当前聚焦“试验领域”的数据汇聚、标准化与洞察展示，提供跨设计/仿真/试验的可视化与分析能力。代码实现为 Next.js App Router 的模块化单页应用，内置多种查看器与对比工具，便于快速验证业务流与交互模式。

### 项目定位
- 服务对象：型号总师、项目经理、设计/仿真/试验/质量等多角色协同。
- 目标价值：打通设计—仿真—试验“连续验证”的证据链，提升需求验证透明度与资料成套性，支撑基线变更与对外交付。
- 能力边界：本项目为数据中心前端原型，聚焦“汇聚/标准化/洞察/服务”；不包含 TDM/现场试验控制与流程执行。

### 关键模块（代码对应）
- 仪表盘 Dashboard（components/dashboard/*）：项目健康、KPI 与近期活动总览。
- 数据探索器 Data Explorer（components/explorer/*）：分面筛选、标签体系与资产列表（示例数据）。
- 产品结构 XBOM/EBOM（components/structure/ebom/*）：EBOM 基线与结构树、摘要卡片、影响分析与评审面板。
- 对比中心 Compare（components/compare/*）：方案/工况/试验-仿真/设计-需求/EBOM 基线差异对比，支持 CSV/PNG 导出。
- 仿真与三维预览（components/structure/preview/*, simulation/*）：
  - PDF 与图片查看（components/common/PdfViewer*.tsx, ImageViewer.tsx）；
  - 在线 3D 查看（online-3d-viewer，occt-import-js，rhino3dm，web-ifc）；
  - VTK 网格预览（vtk.js）。
- 成套性管理（components/completion/*）：按模板统计设计/仿真/试验资料完成度。
- 关系图谱（components/graph/RelationGraph.tsx）：组件关系与状态可视化（示例）。
- 上传管理器/设置（components/upload/*, components/settings/*）：原型级文件队列与配置界面。

### 使用场景示例
- 方案/基线变更评审：在对比中心核对 EBOM 差异、参数/曲线/文档差异并导出证据。
- 需求验证透明化：在结构/对比视图中查看“设计/需求”对齐情况与缺口（示例数据）。
- 资料成套性达标：按模板统计资料完成度，提示缺失项与责任人。

### 数据与集成现状
- 当前为前端原型，使用内置示例/Mock 数据（如 components/structure/ebom/data.ts, simulation/data.ts）。
- 3D 依赖资源通过 `scripts/sync-online3dviewer-assets.js` 同步至 `public/3dviewer`。
- 尚未对接后端域服务（ALM/PLM/试验数据源）；接口与真源将按“项目纪要 附录B”中的 MVP 标准推进。

### 技术栈与配置
- 前端框架：Next.js 15（App Router）、React 19、TypeScript、TailwindCSS。
- 可视化与查看器：recharts、pdfjs-dist、online-3d-viewer、vtk.js、rhino3dm、occt-import-js、web-ifc。
- 构建与脚本：见 `package.json` 与 `next.config.ts`，3D 资源拉取脚本位于 `scripts/`。

## Executive Summary（执行摘要）

本项目是“产品过程数据中心”的一个关键子域原型，当前聚焦“试验领域”。目标是在不改动线下TDM/试验执行系统的前提下，以数据中心方式提供跨设计/仿真/试验的连续验证证据链与决策支持：

- 以统一语义与主数据连接设计配置、仿真结果与试验结果，提升验证透明度与可追溯性；
- 通过对比中心与查看器，支撑方案、工况、试验-仿真、设计-需求及 EBOM 基线差异分析；
- 以“需求验证矩阵（MVP1）”“协同看板与模型校准自动化（MVP2）”“试验知识图谱（MVP3）”为起点，建立可迭代的价值闭环；
- 保持与上游 ALM/PLM、仿真平台、试验结果源系统的解耦，以标准接口集成为主，确保扩展性与合规性。

外延（后续阶段）：将试验域能力与其他产品过程域（如需求、设计、制造、质量）联通，形成端到端的“产品过程数据中心”。

## Goals & Success Metrics（目标与度量）

### Business Objectives（业务目标）
- 在不改动线下TDM的前提下，建立跨设计/仿真/试验的“连续验证”证据链，缩短评审准备时间与异常定位时间；
- 打造面向总师/PM/设计/仿真/试验/质量的统一洞察入口，提高跨角色协同效率；
- 以三大 MVP 为抓手，于第12周交付可演示、可验收的原型闭环（含对外评审材料）；
- 为对接 ALM/PLM/试验结果源系统提供稳定的数据/接口契约与真源判定标准。

### User Success Metrics（用户成功度量）
- 评审准备时间：EBOM/方案差异与关键资料聚合后，评审准备时间下降；
- 需求透明度：需求→用例→结果的链路可见、可追溯，缺口自动标注；
- 协同效率：设计/仿真/试验在异常场景下的联动与回写更顺畅；
- 学习与复用：相似案例与知识图谱可检索、可复用，缩短新人熟化时间。

### KPIs（关键绩效指标）
- 需求闭环周期缩短 ≥ 30%（以历史基线为对照）；
- 矩阵状态一致率 ≥ 99%（与源系统同步差异率 ≤ 1%）；
- 事件→矩阵刷新时延 ≤ 5 分钟，端到端可靠性 ≥ 99.9%；
- 模型校准周期缩短 ≥ 30%，异常定位平均用时下降 ≥ 40%；
- 指标口径一致率 ≥ 98%，手工拼表时间下降 ≥ 80%；
- Top场景追踪链路覆盖率 ≥ 95%，知识包检索命中率（Top-K）≥ 80%，P95 检索延迟 ≤ 1.5s。

### Measurement Plan（度量与基线计划）
- 基线采集：第1–2周锁定 Top 场景与代表性项目，采集历史指标基线（评审准备时长、异常定位用时、需求闭环周期等）。
- 数据来源：
  - ALM/PLM（需求、配置、更改单/版本）；
  - 仿真平台（模型版本、结果、预测）；
  - 试验结果源系统（工况、用例、结果、时间戳）；
  - 前端/看板日志（订阅触达、钻取深度、检索延迟）。
- 统计口径：
  - “一致率”＝1－（不一致条目数/总条目数）；
  - “刷新时延”取事件→可见状态更新的 P95；
  - “命中率Top‑K”按带标注的验证集计算，K=10；
  - “闭环周期”按需求状态从“发现缺口”到“已验证通过”的时长。
- 采样范围：先行两条试验线的 Top N 需求与关键用例，逐步扩圈。

### Ownership & Cadence（负责人与节奏）
- 指标口径/语义注册表：数据治理负责人（周报、变更评审）；
- 需求矩阵与一致性：系统工程/需求负责人（月度复盘）；
- 协同看板与校准任务：仿真负责人（双周）；
- 订阅触达与可观测性：平台负责人（周）；
- 知识图谱质量与检索：知识/培训负责人（月）。

### MVP Acceptance Gates（MVP 验收门槛）
- MVP1 需求验证矩阵：
  - 覆盖 Top 场景链路 ≥ 95%；状态一致率 ≥ 99%；刷新 P95 ≤ 5 分钟；
  - 具备订阅推送与钻取溯源能力；
  - 明确真源（需求/用例/结果）与冲突处理策略。
- MVP2 协同看板与模型校准：
  - 偏差阈值触发→校准任务创建 ≤ 10 分钟；
  - 异常定位平均用时下降 ≥ 40%；
  - 回写模型置信度与关联设计参数，链路可审计。
- MVP3 试验知识图谱：
  - Top‑K 命中 ≥ 80%，P95 检索 ≤ 1.5s；
  - 能从案例一键生成培训包（案例+处置+注意事项）；
  - 季度复发率下降 ≥ 25%。

### Assumptions & Non‑Goals（假设与非目标）
- 假设：上游系统可提供事件/接口最小集；先行域具备可用数据；密级隔离按联邦/特征缓存策略落地。
- 非目标：不承接 TDM/现场试验执行控制；不在本阶段构建全量数据仓或跨域统一权限体系。

## Problem Statement（问题陈述）

在型号研制实践中，试验相关数据分散在 PLM/ALM、仿真平台、台架/实验室系统与文档库中，导致以下问题：

- 指标口径不一致：同名指标跨系统定义不一，评审阶段频繁“对口径”。
- 证据链断裂：需求→用例→结果的链路难以持续、实时地呈现，追溯耗时。
- 人工拼接报表：跨系统导出/拼表形成影子数据，易错且不可复用。
- 模型闭环慢：试验偏差无法快速定位到设计配置/模型版本，校准排程滞后。
- 知识难沉淀：试验案例与处置路径散落于文档与对话，难以检索与培训复用。

边界声明：本项目不替代 TDM/试验执行系统，不控制现场流程；专注“汇聚/标准化/洞察/服务”。

## Proposed Solution（方案概述）

以“产品过程数据中心（试验领域）”为枢纽，构建面向连续验证的轻量数据与应用层：

- 主数据与语义层：统一试验主数据、指标字典与信号语义注册表，作为跨系统的共享语言。
- 集成与事件层：以标准接口与事件驱动（requirement.updated / testcase.result.updated / config.versioned）汇聚关键事实，尽量避免全量复制。
- 验证与矩阵：维护需求×用例×结果的动态图谱，自动更新状态并支持订阅与钻取。
- 协同看板与对比中心：提供方案/工况/试验-仿真/设计-需求/EBOM 基线差异对比与证据导出。
- 知识图谱：将案例、故障模式与处置路径结构化沉淀，支持检索与培训包生成。
- 治理与合规：版本化附件、审计轨迹、权限与密级分层，满足评审与对外交付。

与三大 MVP 对应的增量交付：

1) MVP1 实时需求验证矩阵：打通最小闭环链路，形成“缺口可视化+订阅”的透明机制。
2) MVP2 协同看板与模型校准自动化：以偏差阈值驱动校准任务编排与回写，缩短定位与校准周期。
3) MVP3 试验知识图谱：以 Top 案例为起点，沉淀可检索知识并一键生成培训包。

## Target Users（目标用户）

- 型号总师/项目经理：把握研制节拍、重大里程碑与风险影响度；基于证据链进行裁决。
- 系统工程/需求管理：维护需求→用例→结果链路与一致性，跟踪缺口闭环。
- 设计工程师：查看设计变更对试验/仿真的影响，基于差异对比优化方案。
- 仿真分析主管/工程师：监控模型置信度与偏差触发的校准任务，提升闭环效率。
- 试验工程主管/工程师：利用统一语义与上下文快速定位异常根因，减少手工拼表。
- 质量经理：关注缺陷分布、整改进度与合规可追溯材料的自动化生成。
- 数据治理/平台负责人：指标口径、语义注册表与接口治理，保障可扩展与合规。
- 知识/培训部门：沉淀案例与处置路径，生成可复用的培训包与知识检索。

## MVP Scope（MVP 范围）

### Core Features（Must Have）
- 实时需求验证矩阵（MVP1）：需求×工况×用例×结果链路；事件驱动刷新；订阅/钻取；状态一致性校验。
- 协同看板与模型校准自动化（MVP2）：偏差阈值检测→创建校准任务→回写模型置信度/关联设计参数→可审计链路视图。
- 对比中心增强：设计/需求、试验/仿真、EBOM 基线对比；证据导出（CSV/PNG）；深链路跳转。
- 资料成套性概览：模板化统计缺失项与责任人（利用现有 components/completion）。
- 指标字典/语义注册表（最小集）：统一口径与信号语义登记，支撑一致性与集成。

### Out of Scope（本阶段不纳入）
- TDM/现场试验执行与调度；
- 全量数据仓与跨域统一权限体系；
- 大规模智能推荐/Auto-RootCause（保留规则与轻量算法即可）；
- 复杂离线同步/跨域主备；
- 非试验域的数据中心子域（制造、供应链等）的大范围实现。

### MVP Success Criteria（成功标准）
- 通过《MVP 验收门槛》所列量化指标；
- 演示环境覆盖两条先行试验线 Top 场景；
- 完成一次跨角色评审演示（总师/PM/设计/仿真/试验/质量）。

## Technical Considerations（技术考量）

### Platform Requirements（平台要求）
- Next.js 15（App Router）、React 19、TypeScript、Tailwind；现代浏览器（Chrome/Edge ≥ 120）。
- 性能预算：关键页面首屏 P75 ≤ 2.5s；对比导出 ≤ 2s；3D 载入首包 ≤ 3s（在示例模型场景）。
- 可访问性：键盘可达、焦点样式、语义标签；中英文混排支持。

### Technology Preferences（技术偏好）
- 前端：Next.js + Tailwind + recharts；查看器使用 pdfjs-dist/online-3d-viewer/vtk.js/rhino3dm/occt-import-js/web-ifc。
- 后端（对接期望）：REST/GraphQL 域服务；事件总线 topics：requirement.updated / testcase.result.updated / config.versioned。
- 观测与日志：前端埋点曝光订阅触达、钻取深度与检索延迟（用于 KPI 采集）。

### Architecture Considerations（架构考虑）
- App Router + 客户端组件的分层；对重型模块使用动态 import；
- 接口契约/类型定义与最小真源规则；
- 安全与密级：按区分级访问与最小暴露；
- 可扩展性：模块化路由与组件、特性开关、Mock→真实服务的可替换层。

## Risks & Open Questions（风险与未决）

- 数据可用性：先行域的数据质量/密级脱敏是否满足演示？
- 集成排期：ALM/PLM/试验源系统事件与接口何时可用？
- 性能风险：大规模对比与3D加载的端侧性能与内存占用；
- 合规风险：附件/报告的版本追踪与外发流程；
- 口径争议：指标/信号语义的跨部门协同成本；
- 未决：先行两条试验线的确定、Top 场景清单、事件字段明细与阈值规则。

## Next Steps（下一步）

1. 确认先行域与 Top 场景（2 条试验线）；
2. 冻结事件 schema 与字段（requirement.updated / testcase.result.updated / config.versioned）；
3. 输出接口清单与真源判定（草案），并以 Mock 网关实现最小端到端链路；
4. 落地指标字典/语义注册表（V1.0），接入订阅中心；
5. 实现 MVP1→MVP2→MVP3 的迭代节奏与演示脚本；
6. 建立 KPI 采集与周/双周/月度复盘机制；
7. 组织跨角色评审彩排与材料输出（对外交付包模板）。
